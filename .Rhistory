mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 100000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 200000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 20000,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 90000    # alto logo
)
print(mapa_con_logo)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 100000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 200000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 10000,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 90000    # alto logo
)
print(mapa_con_logo)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 100000*2,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 200000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 10000,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 90000    # alto logo
)
print(mapa_con_logo)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 100000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 200000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 10000,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 90000    # alto logo
)
print(mapa_con_logo)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 150000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 200000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 10000,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 90000    # alto logo
)
print(mapa_con_logo)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 189000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 200000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 10000,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 90000    # alto logo
)
print(mapa_con_logo)
0
0
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 100000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 200000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 10000,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 90000    # alto logo
)
print(mapa_con_logo)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 100000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 200000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 10000,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 100000    # alto logo
)
print(mapa_con_logo)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 100000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 200000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 10000,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 200000    # alto logo
)
print(mapa_con_logo)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 100000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 200000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 10000,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 9000    # alto logo
)
print(mapa_con_logo)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 100000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 200000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 10000,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 10000    # alto logo
)
print(mapa_con_logo)
0
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 100000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 200000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 10000,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 90000    # alto logo
)
print(mapa_con_logo)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 100000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 2000000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 10000,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 90000    # alto logo
)
print(mapa_con_logo)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 100000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 200000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 10000,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 90000    # alto logo
)
print(mapa_con_logo)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 100000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 250000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 10000,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 90000    # alto logo
)
print(mapa_con_logo)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 150000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 250000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 10000,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 90000    # alto logo
)
print(mapa_con_logo)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 190000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 290000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 10000,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 90000    # alto logo
)
print(mapa_con_logo)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 240000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 350000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 10000,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 90000    # alto logo
)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 240000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 350000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 10000,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 90000    # alto logo
)
print(mapa_con_logo)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 270000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 370000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 10000,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 90000    # alto logo
)
print(mapa_con_logo)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 270000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 380000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 10000,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 90000    # alto logo
)
print(mapa_con_logo)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 270000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 380000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 15000,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 90000    # alto logo
)
print(mapa_con_logo)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 270000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 380000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 15000,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 95000    # alto logo
)
print(mapa_con_logo)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 270000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 380000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 25000,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 105000    # alto logo
)
print(mapa_con_logo)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 270000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 380000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 5000,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 85000    # alto logo
)
print(mapa_con_logo)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 270000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 380000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 2000,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 85000    # alto logo
)
print(mapa_con_logo)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 270000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 380000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 1000,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 85000    # alto logo
)
print(mapa_con_logo)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 270000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 380000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 500,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 85000    # alto logo
)
print(mapa_con_logo)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 270000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 380000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 500,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 90000    # alto logo
)
print(mapa_con_logo)
ggsave(
"mapa_final_con_logo.png",
plot = mapa_con_logo,
width = 16, height = 9, units = "in", dpi = 600, bg = "white"
)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 270000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 450000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 500,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 90000    # alto logo
)
print(mapa_con_logo)
ggsave(
"mapa_final_con_logo.png",
plot = mapa_con_logo,
width = 16, height = 9, units = "in", dpi = 600, bg = "white"
)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 270000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 400000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 500,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 90000    # alto logo
)
print(mapa_con_logo)
ggsave(
"mapa_final_con_logo.png",
plot = mapa_con_logo,
width = 16, height = 9, units = "in", dpi = 600, bg = "white"
)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 230000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 40000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 500,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 90000    # alto logo
)
print(mapa_con_logo)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 230000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 400000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 500,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 90000    # alto logo
)
print(mapa_con_logo)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 230000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 380000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 500,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 90000    # alto logo
)
print(mapa_con_logo)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 240000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 380000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 500,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 90000    # alto logo
)
print(mapa_con_logo)
ggsave(
"mapa_final_con_logo.png",
plot = mapa_con_logo,
width = 16, height = 9, units = "in", dpi = 600, bg = "white"
)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 250000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 380000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 500,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 90000    # alto logo
)
print(mapa_con_logo)
mapa_kriging_log <- ggplot() +
geom_stars(data = r_stars) +
scale_fill_stepsn(
name    = "\n(mm)",
colours = c("#b3d9ff", "#66b2ff", "#2c7fb8", "#253494", "#fdd0a2", "#fb6a4a", "#cb181d"),
breaks  = c(0, 10, 50, 100, 150, 180, 240, 300),  # 7 colores = breaks-1
limits  = c(0, 300),
labels  = scales::label_number(accuracy = 1),
na.value = "white") +
geom_sf(data = departamentos_utm, fill = NA, color = "black", linewidth = 0.4) +
geom_sf(data = ciudades_utm, color = "black", size = 2, shape = 19) +
geom_text_repel(data = ciudades_coords,
aes(x = x, y = y, label = nombre),
size = 3,
color = "black",
bg.color = "white",
bg.r = 0.1,
force = 2,
max.overlaps = Inf,
seed = 123) +
coord_sf(crs = st_crs(utm_crs)) +
theme_void() +
theme(
plot.background = element_rect(fill = "white", color = NA),
panel.background = element_rect(fill = "white", color = NA),
plot.title    = element_text(hjust = 0, size = 11, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 11),
legend.position = "right",
legend.title    = element_text(size = 12, face = "bold"),
legend.text     = element_text(size = 11),
plot.margin = margin(20, 20, 20, 20)
) +
labs(
title    = "Precipitación Acumulada",
subtitle = paste0("Periodo",first_reading_str, " - ", last_reading_str)) +
guides(
fill = guide_colorbar(
barwidth  = 1.5,
barheight = 20,
ticks     = TRUE,
frame.colour = "black"
)
)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 250000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 380000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 500,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 90000    # alto logo
)
print(mapa_con_logo)
mapa_kriging_log <- ggplot() +
geom_stars(data = r_stars) +
scale_fill_stepsn(
name    = "\n(mm)",
colours = c("#b3d9ff", "#66b2ff", "#2c7fb8", "#253494", "#fdd0a2", "#fb6a4a", "#cb181d"),
breaks  = c(0, 10, 50, 100, 150, 180, 240, 300),  # 7 colores = breaks-1
limits  = c(0, 300),
labels  = scales::label_number(accuracy = 1),
na.value = "white") +
geom_sf(data = departamentos_utm, fill = NA, color = "black", linewidth = 0.4) +
geom_sf(data = ciudades_utm, color = "black", size = 2, shape = 19) +
geom_text_repel(data = ciudades_coords,
aes(x = x, y = y, label = nombre),
size = 3,
color = "black",
bg.color = "white",
bg.r = 0.1,
force = 2,
max.overlaps = Inf,
seed = 123) +
coord_sf(crs = st_crs(utm_crs)) +
theme_void() +
theme(
plot.background = element_rect(fill = "white", color = NA),
panel.background = element_rect(fill = "white", color = NA),
plot.title    = element_text(hjust = 0, size = 11, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 11),
legend.position = "right",
legend.title    = element_text(size = 12, face = "bold"),
legend.text     = element_text(size = 11),
plot.margin = margin(20, 20, 20, 20)
) +
labs(
title    = "Precipitación Acumulada",
subtitle = paste0(first_reading_str, " a ", last_reading_str)) +
guides(
fill = guide_colorbar(
barwidth  = 1.5,
barheight = 20,
ticks     = TRUE,
frame.colour = "black"
)
)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 250000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 380000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 500,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 90000    # alto logo
)
print(mapa_con_logo)
ggsave(
"mapa_final_con_logo.png",
plot = mapa_con_logo,
width = 16, height = 9, units = "in", dpi = 600, bg = "white"
)
mapa_kriging_log <- ggplot() +
geom_stars(data = r_stars) +
scale_fill_stepsn(
name    = "\n(mm)",
colours = c("#b3d9ff", "#66b2ff", "#2c7fb8", "#253494", "#fdd0a2", "#fb6a4a", "#cb181d"),
breaks  = c(0, 10, 50, 100, 150, 180, 240, 300),  # 7 colores = breaks-1
limits  = c(0, 300),
labels  = scales::label_number(accuracy = 1),
na.value = "white") +
geom_sf(data = departamentos_utm, fill = NA, color = "black", linewidth = 0.4) +
geom_sf(data = ciudades_utm, color = "black", size = 2, shape = 19) +
geom_text_repel(data = ciudades_coords,
aes(x = x, y = y, label = nombre),
size = 3,
color = "black",
bg.color = "white",
bg.r = 0.1,
force = 2,
max.overlaps = Inf,
seed = 123) +
coord_sf(crs = st_crs(utm_crs)) +
theme_void() +
theme(
plot.background = element_rect(fill = "white", color = NA),
panel.background = element_rect(fill = "white", color = NA),
plot.title    = element_text(hjust = 0, size = 13, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 13),
legend.position = "right",
legend.title    = element_text(size = 12, face = "bold"),
legend.text     = element_text(size = 11),
plot.margin = margin(20, 20, 20, 20)
) +
labs(
title    = "Precipitación Acumulada",
subtitle = paste0(first_reading_str, " a ", last_reading_str)) +
guides(
fill = guide_colorbar(
barwidth  = 1.5,
barheight = 20,
ticks     = TRUE,
frame.colour = "black"
)
)
mapa_con_logo <- mapa_kriging_log +
annotation_custom(
logo_grob,
xmin = st_bbox(departamentos_utm)[1] + 250000,   # desplaza en X
xmax = st_bbox(departamentos_utm)[1] + 380000,   # ancho logo
ymin = st_bbox(departamentos_utm)[2] + 500,   # desplaza en Y
ymax = st_bbox(departamentos_utm)[2] + 90000    # alto logo
)
print(mapa_con_logo)
ggsave(
"mapa_final_con_logo.png",
plot = mapa_con_logo,
width = 16, height = 9, units = "in", dpi = 600, bg = "white"
)
